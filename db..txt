-- جدول المستخدمين (متبرعين + مستفيدين + موظفين)
CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    email VARCHAR(150) UNIQUE,
    phone VARCHAR(20),
    role ENUM('donor', 'beneficiary', 'admin') DEFAULT 'donor',
    password VARCHAR(255),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- جدول الخدمات (الخدمات الرئيسية للجمعية)
CREATE TABLE services (
    id INT AUTO_INCREMENT PRIMARY KEY,
    title VARCHAR(150) NOT NULL,
    description TEXT,
    image_url VARCHAR(255),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- جدول الحملات (مثل حملة إفطار صائم، توزيع لحوم، إلخ)
CREATE TABLE campaigns (
    id INT AUTO_INCREMENT PRIMARY KEY,
    title VARCHAR(150) NOT NULL,
    description TEXT,
    goal_amount DECIMAL(10,2) NOT NULL, -- المبلغ المطلوب
    collected_amount DECIMAL(10,2) DEFAULT 0, -- المبلغ الحالي
    image_url VARCHAR(255),
    start_date DATE,
    end_date DATE,
    status ENUM('ongoing', 'completed', 'stopped') DEFAULT 'ongoing',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- جدول التبرعات
CREATE TABLE donations (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NOT NULL, -- المتبرع
    campaign_id INT,      -- التبرع مرتبط بحملة معينة
    service_id INT,       -- أو مرتبط بخدمة عامة
    amount DECIMAL(10,2) NOT NULL,
    payment_method ENUM('cash', 'bank_transfer', 'online') DEFAULT 'cash',
    donated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (campaign_id) REFERENCES campaigns(id),
    FOREIGN KEY (service_id) REFERENCES services(id)
);

-- جدول الإحصائيات (ممكن توليدها ديناميكياً لكن نحط جدول لحفظ الأرقام)
CREATE TABLE statistics (
    id INT AUTO_INCREMENT PRIMARY KEY,
    total_beneficiaries INT DEFAULT 0,
    total_donors INT DEFAULT 0,
    projects_completed INT DEFAULT 0,
    volunteers_count INT DEFAULT 0,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

-- جدول الصور (لو كل حملة أو خدمة فيها صور متعددة)
CREATE TABLE images (
    id INT AUTO_INCREMENT PRIMARY KEY,
    related_type ENUM('campaign', 'service') NOT NULL,
    related_id INT NOT NULL,
    image_url VARCHAR(255) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
